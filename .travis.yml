language: cpp

addons:
  apt:
    sources:
    - boost-latest
    - ubuntu-toolchain-r-test
    packages:
    - gcc-4.9
    - g++-4.9
    - libboost1.55-all-dev
    - libboost1.55-dev

compiler:
    - g++-4.9

#branches:
#    only:
#        - master
        
git:
    submodules: true

before_install:
    - sudo apt-get update -qq
    - sudo apt-get install -qq

install:
    - wget http://ftp.de.debian.org/debian/pool/main/l/lcov/lcov_1.11.orig.tar.gz
    - tar xf lcov_1.11.orig.tar.gz
    - sudo make -C lcov-1.11/ install
    - gem install coveralls-lcov
    - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.9 90
    - sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.9 90
    - sudo update-alternatives --install /usr/bin/gcov gcov /usr/bin/gcov-4.9 90

before_script:

script: 
    - ./install.sh
    - pushd test/build
    - make all
    - ./VFR-Test
    - popd

after_success:
    - pushd test/
    - lcov --directory ./build/src --capture --output-file cov.info
    - lcov -r cov.info /usr/\* -o vfrb.info
    - lcov --list vfrb.info
    - coveralls-lcov --repo-token ${COVERALLS_TOKEN} vfrb.info
    - popd


notifications:
    email:
        recipients:
           - jarthianur.github@gmail.com
        on_success: change
on_failure: change
